package recommendation;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.PrintWriter;
import java.util.Collection;
import java.util.HashMap;
import java.util.List;
import java.util.Set;

import db.MySQLConnection;

public class Export {
	public static void main(String[] args) {
		try (PrintWriter writer = new PrintWriter(new File("test.csv"))) {

			// write column names
			MySQLConnection connection = new MySQLConnection();
			HashMap<String, Integer> map = connection.getIngredientFreq();
//			List<String> freqWords = Model.getFreqWords(map, 10);			
				System.out.println(Model.freqWords);

			StringBuilder sb = new StringBuilder();
			sb.append("item_id");
			sb.append(',');
			for (String s : Model.freqWords) {
				sb.append(s);
				sb.append(',');
			}
			sb.append('\n');

			// insert rows
			HashMap<Integer, List<String>> id_ingred_map = connection.getItemIdIngred();
			Set<Integer> ids = id_ingred_map.keySet();
			Collection<List<String>> ingredients = id_ingred_map.values();

			for (int id : ids) {
				sb.append(id);
				sb.append(',');

				for (String fw : Model.freqWords) {
					if (id_ingred_map.get(id).contains(fw)) {
						sb.append(1);
					} else {
						sb.append(0);
					}
					sb.append(',');
				}
				sb.append('\n');
			}

			writer.write(sb.toString());
			System.out.println("done!");

		} catch (FileNotFoundException e) {
			System.out.println(e.getMessage());
		}
	}

}
